( function( window, $, undefined ) {
	'use strict';

	$( 'nav' ).before( '<button class="menu-toggle" role="button" aria-pressed="false"></button>' ); // Add toggles to menus
	$( 'nav .sub-menu' ).before( '<button class="sub-menu-toggle" role="button" aria-pressed="false"></button>' ); // Add toggles to sub menus

	// Show/hide the navigation
	$( '.menu-toggle, .sub-menu-toggle' ).on( 'click', function() {
		var $this = $( this );
		$this.attr( 'aria-pressed', function( index, value ) {
			return 'false' === value ? 'true' : 'false';
		});

		$this.toggleClass( 'activated' );
		$this.next( 'nav, .sub-menu' ).slideToggle( 'fast' );

	});

})( this, jQuery );

(function($) {
  /* ADDED: make targets focusable */
  $('target[id]').attr('tabindex', '-1');

  $('a[href*=#]:not([href=#])').click(function() {
    var $linkElem = $(this);
    if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') && location.hostname == this.hostname) {
      var target = $(this.hash);
      target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
      if (target.length) {
        $('html,body').animate({
          scrollTop: target.offset().top
        }, 1000, function() {
          /* ADDED: focus the target */
          target.focus();
          /* end ADDED */
          /* ADDED: update the URL */
          window.location.hash = $linkElem.attr('href').substring(1);
         // window.location.hash = $(this).attr('href').substring(1, $(this).attr('href').length);
          /* end ADDED */
        });
        return false;
      }
    }
  });
})(jQuery);

var genacc = ( function( $ ) {
	'use strict';

	/**
	 * Add class to menu item on hover.
	 *
	 * @since 1.1.0
	 */
	var menuItemEnter = function() {
		$( this ).addClass( 'genwpacc-hover' );
	},

	/**
	 * After a short delay, remove a class when mouse leaves menu item.
	 *
	 * @since 1.1.0
	 */
	menuItemLeave = function() {
		$( this ).delay( '250' ).removeClass( 'genwpacc-hover' );
	},

	/**
	 * Toggle menu item class when a link fires a focus or blur event.
	 *
	 * @since 1.0.0
	 */
	menuItemToggleClass = function() {
		$( this ).parents( '.menu-item' ).toggleClass( 'genwpacc-hover' );
	},

	/**
	 * Bind behaviour to events.
	 *
	 * @since 1.1.0
	 */
	ready = function() {
		$( '.menu li' )
			.on( 'mouseenter.genwpacc', menuItemEnter )
			.on( 'mouseleave.genwpacc', menuItemLeave )
			.find( 'a' )
			.on( 'focus.genwpacc blur.genwpacc', menuItemToggleClass );
	};

	// Only expose the ready function to the world
	return {
		ready: ready
	};
})( jQuery );

jQuery( genacc.ready );

// Avoid `console` errors in browsers that lack a console.
// Extracted from HTML5 Boilerplate.
(function() {
    var method;
    var noop = function () {};
    var methods = [
        'assert', 'clear', 'count', 'debug', 'dir', 'dirxml', 'error',
        'exception', 'group', 'groupCollapsed', 'groupEnd', 'info', 'log',
        'markTimeline', 'profile', 'profileEnd', 'table', 'time', 'timeEnd',
        'timeStamp', 'trace', 'warn'
    ];
    var length = methods.length;
    var console = (window.console = window.console || {});

    while (length--) {
        method = methods[length];

        // Only stub undefined methods.
        if (!console[method]) {
            console[method] = noop;
        }
    }
}());

function ga_skiplinks() {
    'use strict';
    var element = document.getElementById( location.hash.substring( 1 ) );

    if ( element ) {
        if ( ! /^(?:a|select|input|button|textarea)$/i.test( element.tagName ) ) {
            element.tabIndex = -1;
        }
        element.focus();
    }
}

if ( window.addEventListener ) {
    window.addEventListener( 'hashchange', ga_skiplinks, false );
} else { // IE8 and earlier
    window.attachEvent( 'onhashchange', ga_skiplinks, false );
}

/*!
 * jQuery Sticky Footer 2.0
 * Corey Snyder
 * http://tangerineindustries.com
 * Modified in-project to account for possibility of multiple footer tags in a page (WordPress)
 *
 * Released under the MIT license
 *
 * Copyright 2013 Corey Snyder.
 *
 * Date: Thu Jan 22 2013 13:34:00 GMT-0630 (Eastern Daylight Time)
 * Modification for jquery 1.9+ Tue May 7 2013
 * Modification for non-jquery, removed all, now classic JS Wed Jun 12 2013
 * Modification for Foundation 5 auto height issues
 * Modification for new DOM change event listener
 */

window.onload = function() {
	stickyFooter();
	observer.observe(target, config);
};

//check for changes to the DOM
var target = document.body;

// create an observer instance
var observer = new MutationObserver(mutationObjectCallback);
function mutationObjectCallback(mutationRecordsList) {
	stickyFooter();
}

// configuration of the observer:
var config = { attributes: true, childList: true, characterData: true };


//check for resize event
window.onresize = function() {
	stickyFooter();
}

function getFooter(elementClass) {
	return document.getElementsByClassName(elementClass)[0];
}

//lets get the marginTop for the <footer>
function getCSS(element, property) {

	var css = null;

	if (element.currentStyle) {
		css = element.currentStyle[property];

	} else if (window.getComputedStyle) {
		css = document.defaultView.getComputedStyle(element, null).
			getPropertyValue(property);
	}

	return css;
}

function stickyFooter() {
	var footer = getFooter("site-footer");

	observer.disconnect();
	document.body.setAttribute("style","height:auto");

	if (footer.getAttribute("style") != null) {
		footer.removeAttribute("style");
	}

	if (window.innerHeight != document.body.offsetHeight) {
		var offset = window.innerHeight - document.body.offsetHeight;
		var current = getCSS(footer, "margin-top");

		if (isNaN(current) == true) {
			footer.setAttribute("style","margin-top:0px;");
			current = 0;
		} else {
			current = parseInt(current);
		}

		if (current+offset > parseInt(getCSS(footer, "margin-top"))) {
			footer.setAttribute("style","margin-top:"+(current+offset)+"px;");
		}
	}

	document.body.setAttribute("style","height:100%");

	//reconnect
	observer.observe(target, config);
}

/*
 ! end sticky footer
 */
